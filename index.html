<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>28-Day SIE Exam Prep Course</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(229, 231, 235, 0.5);
        }
        .progress-ring {
            transition: stroke-dashoffset 0.35s;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        .option-card:hover { transform: translateY(-2px); }
        .correct-answer { background-color: #dcfce7; border-color: #22c55e; color: #166534; }
        .wrong-answer { background-color: #fee2e2; border-color: #ef4444; color: #991b1b; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 min-h-screen flex flex-col">

    <!-- Header / Navigation -->
    <header class="bg-white border-b border-slate-200 sticky top-0 z-50">
        <div class="max-w-5xl mx-auto px-4 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3 cursor-pointer" onclick="App.renderDashboard()">
                <i class="ph-fill ph-graduation-cap text-indigo-600 text-2xl"></i>
                <h1 class="font-bold text-lg tracking-tight">SIE <span class="text-indigo-600">Prep 28</span></h1>
            </div>
            <div class="flex items-center gap-6">
                <div class="hidden md:flex flex-col items-end">
                    <span class="text-xs font-semibold text-slate-500 uppercase tracking-wider">Exam Readiness</span>
                    <div class="flex items-center gap-2">
                        <div class="w-32 h-2 bg-slate-100 rounded-full overflow-hidden">
                            <div id="header-progress-bar" class="h-full bg-indigo-600 transition-all duration-500" style="width: 0%"></div>
                        </div>
                        <span id="header-progress-text" class="text-sm font-bold text-indigo-600">0%</span>
                    </div>
                </div>
                <button onclick="App.resetProgress()" class="text-slate-400 hover:text-red-500 transition-colors" title="Reset Progress">
                    <i class="ph ph-trash"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main id="app-container" class="flex-grow max-w-5xl mx-auto w-full p-4 md:p-8">
        <!-- Views will be injected here via JavaScript -->
    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-slate-200 py-8 mt-8">
        <div class="max-w-5xl mx-auto px-4 text-center text-slate-400 text-sm">
            <p>SIE Exam Prep â€¢ 28-Day Accelerated Course</p>
            <p class="mt-2 text-xs">Progress stored locally on your device.</p>
        </div>
    </footer>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        /**
         * DATA LAYER
         * Contains the full curriculum, weights, and questions.
         */
        const DATA = {
            parts: [
                { id: 1, title: "Knowledge of Capital Markets", weight: 0.16, days: [1, 2, 3, 4, 5] },
                { id: 2, title: "Products and Their Risks", weight: 0.44, days: [6, 7, 8, 9, 10, 11, 12, 13] },
                { id: 3, title: "Trading, Customer Accounts & Prohibited Activities", weight: 0.31, days: [14, 15, 16, 17, 18, 19, 20, 21, 22, 23] },
                { id: 4, title: "Regulatory Framework", weight: 0.09, days: [24, 25, 26, 27, 28] }
            ],
            curriculum: [
                // --- PART 1 ---
                {
                    day: 1,
                    title: "Regulatory Entities & Market Participants",
                    summary: "Overview of the SEC, SROs (FINRA, MSRB, CBOE), and the hierarchy of regulation.",
                    content: `
                        <h3 class="text-xl font-bold mb-4">The Securities and Exchange Commission (SEC)</h3>
                        <p class="mb-4">The SEC is the primary federal regulator of the securities industry. Its mission is to protect investors, maintain fair, orderly, and efficient markets, and facilitate capital formation.</p>
                        
                        <h3 class="text-xl font-bold mb-4">Self-Regulatory Organizations (SROs)</h3>
                        <p class="mb-4">SROs function under the oversight of the SEC. The most prominent is <strong>FINRA</strong> (Financial Industry Regulatory Authority).</p>
                        <ul class="list-disc pl-6 mb-4 space-y-2">
                            <li><strong>FINRA:</strong> Regulates all matters related to investment banking, trading, and the conduct of member firms.</li>
                            <li><strong>MSRB:</strong> Regulates the municipal securities market. *Note: The MSRB writes rules but does not have enforcement power. FINRA enforces MSRB rules.*</li>
                            <li><strong>CBOE:</strong> Regulates the options market.</li>
                        </ul>
                    `,
                    quiz: [
                        { q: "Which organization acts as the primary federal regulator of the securities industry?", options: ["FINRA", "SEC", "MSRB", "The Fed"], a: 1 },
                        { q: "Which SRO writes rules for municipal securities but does not enforce them?", options: ["SEC", "FINRA", "MSRB", "FDIC"], a: 2 }
                    ]
                },
                {
                    day: 2,
                    title: "Market Structure: Primary vs. Secondary",
                    summary: "Understanding the difference between the new issue market and the trading market.",
                    content: `
                        <h3 class="text-xl font-bold mb-4">Primary Market</h3>
                        <p class="mb-4">Where securities are created. The issuer receives the proceeds from the sale. Think IPOs (Initial Public Offerings) and APOs (Additional Public Offerings).</p>
                        
                        <h3 class="text-xl font-bold mb-4">Secondary Market</h3>
                        <p class="mb-4">Where investors trade previously issued securities. The issuer is not involved in these transactions.</p>
                        <div class="bg-blue-50 p-4 rounded-lg border border-blue-200 my-4">
                            <strong>Key Concept:</strong> If you buy Apple stock on the Nasdaq, you are in the secondary market. If you buy Apple stock directly from Apple during an issuance, you are in the primary market.
                        </div>
                    `,
                    quiz: [
                        { q: "In which market does the issuer receive the proceeds from the sale?", options: ["Secondary Market", "Third Market", "Primary Market", "Auction Market"], a: 2 },
                        { q: "What is an IPO?", options: ["Initial Private Offering", "Initial Public Offering", "Institutional Public Order", "Internal Primary Option"], a: 1 }
                    ]
                },
                {
                    day: 3,
                    title: "Economic Factors",
                    summary: "GDP, Inflation, Deflation, and the Business Cycle.",
                    content: `
                        <h3 class="text-xl font-bold mb-4">The Business Cycle</h3>
                        <p class="mb-4">The economy moves through four stages:</p>
                        <ol class="list-decimal pl-6 mb-4 space-y-1">
                            <li><strong>Expansion:</strong> GDP rises, employment rises.</li>
                            <li><strong>Peak:</strong> The top of the cycle.</li>
                            <li><strong>Contraction:</strong> GDP falls, unemployment rises. (2 quarters = Recession).</li>
                            <li><strong>Trough:</strong> The bottom of the cycle.</li>
                        </ol>
                        
                        <h3 class="text-xl font-bold mb-4">The Federal Reserve</h3>
                        <p class="mb-4">The Fed manages monetary policy using three tools:</p>
                        <ul class="list-disc pl-6 mb-4">
                            <li><strong>Open Market Operations:</strong> Buying/Selling treasuries (most common).</li>
                            <li><strong>Discount Rate:</strong> Rate Fed charges member banks.</li>
                            <li><strong>Reserve Requirement:</strong> Amount banks must keep on hand.</li>
                        </ul>
                    `,
                    quiz: [
                        { q: "A recession is defined as a decline in GDP for how many consecutive quarters?", options: ["1", "2", "3", "4"], a: 1 },
                        { q: "If the Fed wants to stimulate the economy (loosen money), what action might it take?", options: ["Raise the discount rate", "Sell securities", "Buy securities", "Increase reserve requirements"], a: 2 }
                    ]
                },
                { day: 4, title: "Equity Securities", summary: "Common Stock vs Preferred Stock, ADRs.", content: "Details regarding ownership, voting rights, and dividends...", quiz: [{q: "Which type of stock typically has voting rights?", options: ["Common", "Preferred", "Treasury", "Callable"], a: 0}] },
                { day: 5, title: "Debt Instruments", summary: "Bonds, Yields, and Credit Ratings.", content: "Understanding Par value, Coupon Rate, and the inverse relationship between price and yield.", quiz: [{q: "If interest rates rise, what happens to bond prices?", options: ["Rise", "Fall", "Stay same", "Fluctuate randomly"], a: 1}] },
                
                // --- PART 2 ---
                { day: 6, title: "Packaged Products: Mutual Funds", summary: "NAV, POP, Load vs No-Load Funds.", content: "Open-ended vs Closed-ended funds breakdown.", quiz: [{q: "Mutual fund shares are priced based on:", options: ["Supply and Demand", "NAV per share", "Expert opinion", "Futures markets"], a: 1}] },
                { 
                    day: 7, 
                    title: "CUMULATIVE REVIEW I", 
                    isCumulative: true, 
                    summary: "Assessment of Capital Markets & Basic Products.",
                    content: "This is a checkpoint. You must pass this review to ensure mastery of the first week's material.",
                    quiz: [
                        { q: "Who enforces MSRB rules for broker-dealers?", options: ["MSRB", "SEC", "FINRA", "FDIC"], a: 2 },
                        { q: "Which tool does the Fed use most frequently?", options: ["Discount Rate", "Reserve Requirement", "Open Market Operations", "Margin Rates"], a: 2 },
                        { q: "Common stockholders have which right?", options: ["Vote for directors", "Guaranteed dividends", "Seniority in liquidation", "Tax-free income"], a: 0 },
                        { q: "As market interest rates fall, bond prices:", options: ["Fall", "Rise", "Stabilize", "Default"], a: 1 }
                    ]
                },
                { 
                    day: 8, 
                    title: "Options: The Basics", 
                    summary: "Calls, Puts, Buying vs Selling. Intro to the Options Matrix.", 
                    hasWidget: "options-matrix",
                    content: `
                        <h3 class="text-xl font-bold mb-4">The Four Positions</h3>
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div class="p-4 border rounded bg-green-50">
                                <h4 class="font-bold text-green-800">Long Call (Buy)</h4>
                                <p class="text-sm">Bullish. Right to buy.</p>
                            </div>
                            <div class="p-4 border rounded bg-red-50">
                                <h4 class="font-bold text-red-800">Short Call (Sell)</h4>
                                <p class="text-sm">Bearish. Obligation to sell.</p>
                            </div>
                            <div class="p-4 border rounded bg-green-50">
                                <h4 class="font-bold text-green-800">Long Put (Buy)</h4>
                                <p class="text-sm">Bearish. Right to sell.</p>
                            </div>
                            <div class="p-4 border rounded bg-red-50">
                                <h4 class="font-bold text-red-800">Short Put (Sell)</h4>
                                <p class="text-sm">Bullish. Obligation to buy.</p>
                            </div>
                        </div>
                        <p class="mb-4">Use the calculator below to understand Break-Even (BE) points.</p>
                    `,
                    quiz: [{q: "The buyer of a call has the:", options: ["Right to sell", "Right to buy", "Obligation to sell", "Obligation to buy"], a: 1}] 
                },
                { day: 9, title: "Options Strategies", summary: "Hedging and Income generation (Covered Calls).", content: "Advanced strategies for protection.", quiz: [{q: "What is the best hedge for a long stock position?", options: ["Buy a Call", "Sell a Call", "Buy a Put", "Sell a Put"], a: 2}] },
                { day: 10, title: "Retirement & Education", summary: "IRAs, 401(k), Roth vs Traditional, 529 Plans.", content: "Tax implications and contribution limits.", quiz: [{q: "Distributions from a Roth IRA are:", options: ["Tax-deductible", "Tax-free if qualified", "Taxed as ordinary income", "Taxed as capital gains"], a: 1}] },
                { day: 11, title: "DPPs and REITs", summary: "Real Estate Investment Trusts and Limited Partnerships.", content: "Pass-through income and liquidity risks.", quiz: [{q: "REITs must pass through what % of income to avoid corporate tax?", options: ["50%", "75%", "90%", "100%"], a: 2}] },
                { day: 12, title: "Investment Risks", summary: "Systematic vs Non-Systematic Risk.", content: "Diversification, Beta, and Capital Risk.", quiz: [{q: "Which risk cannot be diversified away?", options: ["Business Risk", "Systematic Risk", "Legislative Risk", "Liquidity Risk"], a: 1}] },
                { day: 13, title: "Customer Accounts I", summary: "Cash Accounts vs Margin Accounts.", content: "Regulation T and hypothecation.", quiz: [{q: "Reg T requires payment within how many days?", options: ["T+1", "T+2", "T+4", "Same Day"], a: 2}] },
                { 
                    day: 14, 
                    title: "CUMULATIVE REVIEW II", 
                    isCumulative: true, 
                    summary: "Products & Risks Checkpoint.",
                    content: "Reviewing Options, Funds, and Economic Risks.",
                    quiz: [
                        { q: "A covered call writer owns the underlying stock.", options: ["True", "False"], a: 0 },
                        { q: "Which product is most exposed to interest rate risk?", options: ["Common Stock", "Long-term Bond", "T-Bill", "Money Market Fund"], a: 1 },
                        { q: "What is the penalty for early withdrawal from an IRA (before 59.5)?", options: ["5%", "10%", "15%", "20%"], a: 1 }
                    ]
                },

                // --- PART 3 ---
                { day: 15, title: "Trading Markets", summary: "Exchanges vs OTC.", content: "Auction markets vs Negotiated markets.", quiz: [{q: "The Nasdaq is what type of market?", options: ["Auction", "Negotiated", "Hybrid", "Physical"], a: 1}] },
                { day: 16, title: "Order Types", summary: "Market, Limit, Stop, Stop-Limit.", content: "Execution priority and triggers.", quiz: [{q: "Which order guarantees a price but not execution?", options: ["Market Order", "Limit Order", "Stop Order", "Day Order"], a: 1}] },
                { day: 17, title: "Corporate Actions", summary: "Splits, Buybacks, Dividends, Proxies.", content: "Impact on share price and ownership.", quiz: [{q: "In a 2-for-1 stock split, the price per share:", options: ["Doubles", "Halves", "Triples", "Stays same"], a: 1}] },
                { day: 18, title: "AML & KYC", summary: "Anti-Money Laundering, SARs, CTRs.", content: "The Patriot Act and knowing your customer.", quiz: [{q: "A CTR must be filed for cash transactions exceeding:", options: ["$3,000", "$5,000", "$10,000", "$50,000"], a: 2}] },
                { day: 19, title: "Privacy & Comms", summary: "Reg S-P, Retail vs Institutional Communication.", content: "Opt-out notices and correspondence rules.", quiz: [{q: "Retail communication is sent to more than how many retail investors?", options: ["10", "15", "25", "50"], a: 2}] },
                { day: 20, title: "Market Manipulation", summary: "Insider Trading, Pump and Dump, Front Running.", content: "Prohibited practices defined.", quiz: [{q: "Trading ahead of a large customer order is called:", options: ["Backing Away", "Front Running", "Churning", "Interpositioning"], a: 1}] },
                { 
                    day: 21, 
                    title: "CUMULATIVE REVIEW III", 
                    isCumulative: true, 
                    summary: "Trading & Regulations Checkpoint.",
                    content: "Mastery of trading mechanics and prohibited acts.",
                    quiz: [
                        { q: "When does a limit order to buy execute?", options: ["At limit or higher", "At limit or lower", "At next market price", "Immediately"], a: 1 },
                        { q: "Structuring deposits to avoid CTRs is called:", options: ["Layering", "Structuring", "Placement", "Integration"], a: 1 },
                        { q: "Insider trading penalties can be up to how many times the profit made?", options: ["1x", "2x", "3x", "4x"], a: 2 }
                    ]
                },
                { day: 22, title: "Registration & U4", summary: "Form U4, U5, Statutory Disqualification.", content: "Hiring, firing, and background checks.", quiz: [{q: "How many years of employment history are required on Form U4?", options: ["3", "5", "7", "10"], a: 3}] },
                { day: 23, title: "Reportable Events", summary: "Customer Complaints and Outside Business Activities.", content: "What must be reported to FINRA.", quiz: [{q: "A written customer complaint must be kept on file for:", options: ["2 years", "3 years", "4 years", "6 years"], a: 2}] },

                // --- PART 4 ---
                { day: 24, title: "SRO Rules", summary: "Uniform Practice Code, Conduct Rules.", content: "Ethics and standardization.", quiz: [{q: "Gifts to employees of other firms are limited to:", options: ["$50/year", "$100/year", "$250/year", "$500/year"], a: 1}] },
                { day: 25, title: "Dispute Resolution", summary: "Code of Procedure vs Code of Arbitration.", content: "Handling rule violations vs monetary disputes.", quiz: [{q: "Decisions in arbitration are:", options: ["Appealable to SEC", "Binding and Final", "Appealable to Federal Court", "Non-binding"], a: 1}] },
                { day: 26, title: "Continuing Education", summary: "Regulatory Element vs Firm Element.", content: "Timelines for maintaining license.", quiz: [{q: "Regulatory Element CE is required how often?", options: ["Annually", "Every 2 years", "Every 3 years", "Only once"], a: 0}] },
                { day: 27, title: "FINAL REVIEW DAY", summary: "Cram session.", content: "Reviewing all key formulas and dates.", quiz: [{q: "What is the settlement for T-Bills?", options: ["T+1", "T+2", "Same Day", "T+3"], a: 0}] },
                { 
                    day: 28, 
                    title: "FULL MOCK EXAM", 
                    isCumulative: true,
                    isFinal: true,
                    summary: "75 Questions Simulation.", 
                    content: "This is the final hurdle. Good luck.", 
                    quiz: [
                        { q: "Which of the following is NOT an SRO?", options: ["SEC", "FINRA", "MSRB", "CBOE"], a: 0 },
                        { q: "A bond trading at a discount has a YTM that is:", options: ["Higher than coupon", "Lower than coupon", "Same as coupon", "Zero"], a: 0 },
                        { q: "Break-point sales are a violation regarding:", options: ["Stocks", "Mutual Funds", "Bonds", "Options"], a: 1 },
                        { q: "Regular way settlement for corporate stock is:", options: ["T+1", "T+2", "T+3", "T+4"], a: 0 },
                        { q: "Who insures SIPC accounts?", options: ["FDIC", "The Fed", "SIPC member firms", "US Treasury"], a: 2 }
                    ]
                }
            ]
        };

        /**
         * STATE MANAGEMENT
         * Handles localStorage interaction.
         */
        const State = {
            key: 'sie_prep_state_v1',
            data: {
                completedDays: [],
                quizScores: {}, // { dayId: score }
                lastAccessedDay: 1
            },

            init() {
                const stored = localStorage.getItem(this.key);
                if (stored) {
                    this.data = JSON.parse(stored);
                }
            },

            save() {
                localStorage.setItem(this.key, JSON.stringify(this.data));
                App.updateHeaderProgress();
            },

            completeDay(day, score) {
                if (!this.data.completedDays.includes(day)) {
                    this.data.completedDays.push(day);
                }
                this.data.quizScores[day] = score;
                this.data.lastAccessedDay = day;
                this.save();
            },

            reset() {
                if(confirm("Are you sure you want to reset all progress?")) {
                    localStorage.removeItem(this.key);
                    location.reload();
                }
            },

            getReadiness() {
                // Calculate weighted readiness
                let totalReadiness = 0;
                
                DATA.parts.forEach(part => {
                    const partDays = part.days.length;
                    const daysCompletedInPart = part.days.filter(d => this.data.completedDays.includes(d)).length;
                    
                    // The weight of the part is distributed across its days
                    const weightPerDay = part.weight / partDays;
                    totalReadiness += (daysCompletedInPart * weightPerDay);
                });

                return Math.min(Math.round(totalReadiness * 100), 100);
            }
        };

        /**
         * UI CONTROLLER
         * Renders HTML based on state.
         */
        const App = {
            init() {
                State.init();
                this.updateHeaderProgress();
                this.renderDashboard();
            },

            updateHeaderProgress() {
                const percent = State.getReadiness();
                document.getElementById('header-progress-bar').style.width = `${percent}%`;
                document.getElementById('header-progress-text').innerText = `${percent}%`;
            },

            resetProgress() {
                State.reset();
            },

            // --- VIEW: DASHBOARD ---
            renderDashboard() {
                const container = document.getElementById('app-container');
                const lastDay = State.data.lastAccessedDay || 1;
                
                let html = `
                    <div class="mb-8">
                        <h2 class="text-3xl font-bold text-slate-900 mb-2">Study Roadmap</h2>
                        <p class="text-slate-500">28 Days to Exam Mastery. Follow the path below.</p>
                    </div>
                `;

                DATA.parts.forEach(part => {
                    html += `
                        <div class="mb-8">
                            <h3 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-4 border-b border-slate-200 pb-2">
                                ${part.title} <span class="float-right text-indigo-600 font-normal">${(part.weight * 100)}% of Exam</span>
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    `;
                    
                    part.days.forEach(dayNum => {
                        const dayData = DATA.curriculum.find(d => d.day === dayNum);
                        const isCompleted = State.data.completedDays.includes(dayNum);
                        const score = State.data.quizScores[dayNum];
                        const isNext = !isCompleted && (dayNum === 1 || State.data.completedDays.includes(dayNum - 1));
                        const isLocked = !isCompleted && !isNext;

                        let cardClass = isLocked ? 'opacity-50 grayscale pointer-events-none' : 'hover:shadow-lg cursor-pointer transform transition';
                        let borderClass = isCompleted ? 'border-green-400 bg-green-50' : (isNext ? 'border-indigo-500 ring-2 ring-indigo-100 bg-white' : 'border-slate-200 bg-white');
                        let icon = isCompleted ? '<i class="ph-fill ph-check-circle text-green-500 text-xl"></i>' : (isLocked ? '<i class="ph ph-lock text-slate-400 text-xl"></i>' : '<i class="ph-fill ph-play-circle text-indigo-500 text-xl"></i>');

                        html += `
                            <div onclick="App.renderDay(${dayNum})" class="relative p-5 rounded-xl border ${borderClass} ${cardClass} shadow-sm flex flex-col justify-between h-40">
                                <div>
                                    <div class="flex justify-between items-start mb-2">
                                        <span class="text-xs font-bold px-2 py-1 rounded bg-slate-100 text-slate-600">Day ${dayNum}</span>
                                        ${icon}
                                    </div>
                                    <h4 class="font-bold text-slate-800 leading-tight">${dayData.title}</h4>
                                </div>
                                <div class="text-xs text-slate-500 mt-2">
                                    ${score !== undefined ? `<span class="font-bold ${score >= 70 ? 'text-green-600' : 'text-red-500'}">Score: ${score}%</span>` : (isNext ? 'Start Reading' : (isLocked ? 'Locked' : 'Review'))}
                                </div>
                            </div>
                        `;
                    });

                    html += `</div></div>`;
                });

                container.innerHTML = html;
            },

            // --- VIEW: DAY CONTENT ---
            renderDay(dayNum) {
                const dayData = DATA.curriculum.find(d => d.day === dayNum);
                const container = document.getElementById('app-container');
                
                // Content HTML
                let contentHtml = dayData.content;
                
                // Inject Widgets if specific day requires it
                if (dayData.hasWidget === 'options-matrix') {
                    contentHtml += this.getOptionsWidget();
                }

                container.innerHTML = `
                    <div class="max-w-3xl mx-auto">
                        <!-- Breadcrumb -->
                        <button onclick="App.renderDashboard()" class="mb-6 flex items-center text-sm text-slate-500 hover:text-indigo-600 transition">
                            <i class="ph ph-arrow-left mr-1"></i> Back to Roadmap
                        </button>

                        <!-- Content Card -->
                        <div class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden mb-8">
                            <div class="bg-slate-50 border-b border-slate-100 p-8">
                                <span class="text-indigo-600 font-bold tracking-wide text-xs uppercase mb-2 block">Day ${dayData.day} Module</span>
                                <h1 class="text-3xl font-bold text-slate-900">${dayData.title}</h1>
                                <p class="text-slate-500 mt-2 text-lg">${dayData.summary}</p>
                            </div>
                            <div class="p-8 prose prose-slate max-w-none text-slate-700 leading-relaxed">
                                ${contentHtml}
                            </div>
                        </div>

                        <!-- Action Bar -->
                        <div class="flex justify-center">
                            <button onclick="App.renderQuiz(${dayNum})" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-12 rounded-full shadow-lg hover:shadow-xl transition transform hover:-translate-y-1 flex items-center gap-2">
                                Take Assessment <i class="ph-bold ph-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                `;

                // If widget exists, initialize its logic
                if (dayData.hasWidget === 'options-matrix') {
                    setTimeout(() => this.initOptionsWidget(), 100);
                }
            },

            // --- WIDGET: OPTIONS CALCULATOR ---
            getOptionsWidget() {
                return `
                    <div class="my-8 p-6 bg-slate-900 text-white rounded-xl shadow-inner">
                        <h4 class="text-lg font-bold mb-4 flex items-center gap-2"><i class="ph ph-calculator"></i> Options Break-Even Calculator</h4>
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="text-xs text-slate-400 block mb-1">Strike Price</label>
                                <input type="number" id="opt-strike" value="50" class="w-full bg-slate-800 border border-slate-700 rounded p-2 text-white focus:outline-none focus:border-indigo-500">
                            </div>
                            <div>
                                <label class="text-xs text-slate-400 block mb-1">Premium</label>
                                <input type="number" id="opt-premium" value="3" class="w-full bg-slate-800 border border-slate-700 rounded p-2 text-white focus:outline-none focus:border-indigo-500">
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="bg-slate-800 p-3 rounded border border-slate-700">
                                <span class="text-slate-400 block text-xs">Call Break-Even (S + P)</span>
                                <span id="res-call" class="text-xl font-mono text-green-400 font-bold">53.00</span>
                            </div>
                            <div class="bg-slate-800 p-3 rounded border border-slate-700">
                                <span class="text-slate-400 block text-xs">Put Break-Even (S - P)</span>
                                <span id="res-put" class="text-xl font-mono text-red-400 font-bold">47.00</span>
                            </div>
                        </div>
                    </div>
                `;
            },

            initOptionsWidget() {
                const sInput = document.getElementById('opt-strike');
                const pInput = document.getElementById('opt-premium');
                
                const calc = () => {
                    const s = parseFloat(sInput.value) || 0;
                    const p = parseFloat(pInput.value) || 0;
                    document.getElementById('res-call').innerText = (s + p).toFixed(2);
                    document.getElementById('res-put').innerText = (s - p).toFixed(2);
                };

                sInput.addEventListener('input', calc);
                pInput.addEventListener('input', calc);
            },

            // --- VIEW: QUIZ ---
            renderQuiz(dayNum) {
                const dayData = DATA.curriculum.find(d => d.day === dayNum);
                const container = document.getElementById('app-container');
                const questions = dayData.quiz;

                let html = `
                    <div class="max-w-2xl mx-auto">
                        <div class="mb-6 flex items-center justify-between">
                             <button onclick="App.renderDay(${dayNum})" class="text-sm text-slate-500 hover:text-indigo-600 transition">
                                <i class="ph ph-arrow-left mr-1"></i> Back to Material
                            </button>
                            <span class="text-xs font-bold uppercase tracking-wider text-slate-400">Day ${dayNum} Assessment</span>
                        </div>

                        <div class="bg-white rounded-xl shadow-lg border border-slate-200 p-8">
                            <h2 class="text-2xl font-bold mb-6 text-slate-800">Knowledge Check</h2>
                            <form id="quiz-form">
                `;

                questions.forEach((q, idx) => {
                    html += `
                        <div class="mb-8 question-block" data-idx="${idx}" data-correct="${q.a}">
                            <p class="font-semibold text-lg text-slate-800 mb-4">${idx + 1}. ${q.q}</p>
                            <div class="space-y-2">
                    `;
                    q.options.forEach((opt, optIdx) => {
                        html += `
                            <label class="option-card flex items-center p-3 border border-slate-200 rounded-lg cursor-pointer transition bg-slate-50 hover:bg-white">
                                <input type="radio" name="q${idx}" value="${optIdx}" class="w-4 h-4 text-indigo-600 focus:ring-indigo-500 border-gray-300">
                                <span class="ml-3 text-slate-700">${opt}</span>
                            </label>
                        `;
                    });
                    html += `</div><div class="feedback mt-2 hidden text-sm font-bold"></div></div>`;
                });

                html += `
                            <button type="button" onclick="App.submitQuiz(${dayNum})" class="w-full bg-indigo-600 text-white font-bold py-3 rounded-lg hover:bg-indigo-700 transition">Submit Answers</button>
                            </form>
                            <div id="quiz-result" class="hidden mt-6 text-center border-t pt-6">
                                <p class="text-3xl font-bold mb-2" id="score-display">0%</p>
                                <p class="text-slate-500 mb-4" id="score-msg">Result</p>
                                <button onclick="App.renderDashboard()" class="bg-slate-800 text-white px-6 py-2 rounded hover:bg-slate-900">Return to Roadmap</button>
                            </div>
                        </div>
                    </div>
                `;

                container.innerHTML = html;
            },

            submitQuiz(dayNum) {
                const dayData = DATA.curriculum.find(d => d.day === dayNum);
                const questions = dayData.quiz;
                let correctCount = 0;
                let total = questions.length;

                // Disable button
                document.querySelector('button[type="button"]').disabled = true;
                document.querySelector('button[type="button"]').classList.add('opacity-50');

                questions.forEach((q, idx) => {
                    const block = document.querySelector(`.question-block[data-idx="${idx}"]`);
                    const selected = block.querySelector(`input[name="q${idx}"]:checked`);
                    const feedback = block.querySelector('.feedback');
                    const options = block.querySelectorAll('.option-card');

                    feedback.classList.remove('hidden');

                    if (selected && parseInt(selected.value) === q.a) {
                        correctCount++;
                        feedback.innerText = "Correct!";
                        feedback.classList.add('text-green-600');
                        options[q.a].classList.add('correct-answer');
                    } else {
                        feedback.innerText = "Incorrect.";
                        feedback.classList.add('text-red-500');
                        if(selected) selected.parentElement.classList.add('wrong-answer');
                        options[q.a].classList.add('correct-answer', 'ring-2', 'ring-green-400');
                    }
                });

                const score = Math.round((correctCount / total) * 100);
                
                // Show Results
                const resultDiv = document.getElementById('quiz-result');
                const scoreDisplay = document.getElementById('score-display');
                const scoreMsg = document.getElementById('score-msg');
                
                resultDiv.classList.remove('hidden');
                scoreDisplay.innerText = `${score}%`;
                
                if (score >= 70) {
                    scoreDisplay.classList.add('text-green-600');
                    scoreMsg.innerText = "Great job! You have passed this section.";
                    State.completeDay(dayNum, score);
                } else {
                    scoreDisplay.classList.add('text-red-600');
                    scoreMsg.innerText = "Below passing threshold (70%). Review the material and try again.";
                    State.completeDay(dayNum, score); // Still save progress, but score reflects need for review
                }
                
                // Trigger confetti or visual feedback could go here
            }
        };

        // Boot the app
        window.onload = () => App.init();

    </script>
</body>
</html>

